(window.webpackJsonp=window.webpackJsonp||[]).push([[90],{387:function(s,a,n){"use strict";n.r(a);var t=n(4),e=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"第二篇-如何用高德地图api获取灵川县乡镇3d乡镇边界线"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第二篇-如何用高德地图api获取灵川县乡镇3d乡镇边界线"}},[s._v("#")]),s._v(" 第二篇，如何用高德地图API获取灵川县乡镇3D乡镇边界线！")]),s._v(" "),a("blockquote",[a("p",[s._v("作者："),a("a",{attrs:{href:"https://java.springsongs.cn",target:"_blank",rel:"noopener noreferrer"}},[s._v("极光"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("本站地址："),a("a",{attrs:{href:"http://springsongs.cn",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://springsongs.cn"),a("OutboundLink")],1),s._v(" "),a("img",{staticClass:"lazy",attrs:{alt:"image-20250715143140613","data-src":"http://springsongs.cn/images/image-20250715143140613.png",loading:"lazy"}})])]),s._v(" "),a("h2",{attrs:{id:"实战效果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实战效果"}},[s._v("#")]),s._v(" 实战效果")]),s._v(" "),a("ul",[a("li",[s._v("灵川县完整县界高亮显示")]),s._v(" "),a("li",[s._v("县内各乡镇边界、名称自动绘制与展示")]),s._v(" "),a("li",[s._v("支持3D地形及倾斜效果")]),s._v(" "),a("li",[s._v("支持GeoJSON乡镇数据动态加载")])]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"技术选型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#技术选型"}},[s._v("#")]),s._v(" 技术选型")]),s._v(" "),a("ul",[a("li",[s._v("高德地图 JS API（v1.4.15）")]),s._v(" "),a("li",[s._v("Turf.js（计算几何中心）")]),s._v(" "),a("li",[s._v("jQuery（简化 AJAX 请求）")])]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"主要步骤与完整代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#主要步骤与完整代码"}},[s._v("#")]),s._v(" 主要步骤与完整代码")]),s._v(" "),a("h3",{attrs:{id:"_1️⃣-页面结构搭建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1️⃣-页面结构搭建"}},[s._v("#")]),s._v(" 1️⃣ 页面结构搭建")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('html\n\n\nCopyEdit\n<div id="AllmapContainer"></div>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("ul",[a("li",[s._v("创建地图容器，设置全屏大小。")])]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"_2️⃣-引入依赖"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2️⃣-引入依赖"}},[s._v("#")]),s._v(" 2️⃣ 引入依赖")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('htmlCopyEdit<script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"><\/script>\n<script src="https://webapi.amap.com/maps?v=1.4.15&key=你的key&plugin=Map3D,AMap.DistrictSearch"><\/script>\n<script src="https://unpkg.com/@turf/turf@6/turf.min.js"><\/script>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ul",[a("li",[s._v("高德地图 API")]),s._v(" "),a("li",[s._v("Turf.js 用于计算几何中心")]),s._v(" "),a("li",[s._v("jQuery 处理 GeoJSON 数据请求")])]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"_3️⃣-初始化地图-关键"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3️⃣-初始化地图-关键"}},[s._v("#")]),s._v(" 3️⃣ 初始化地图（关键）")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("function initMap(callback) {\n    const opts = { subdistrict: 2, extensions: 'all', level: 'city' };\n    const district = new AMap.DistrictSearch(opts);\n\n    district.search('灵川县', function(status, result) {\n        const countyData = result.districtList[0];\n        const bounds = countyData.boundaries;\n        create3DMap(bounds);\n        drawCountyBoundary(bounds);\n        drawTownships();\n        if (callback) callback();\n    });\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("ul",[a("li",[s._v("利用 "),a("strong",[s._v("AMap.DistrictSearch")]),s._v(" 获取灵川县边界")]),s._v(" "),a("li",[s._v("回调处理：创建地图、绘制县界、加载乡镇")])]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"_4️⃣-创建3d地图-县界遮罩"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4️⃣-创建3d地图-县界遮罩"}},[s._v("#")]),s._v(" 4️⃣ 创建3D地图+县界遮罩")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("function create3DMap(boundaries) {\n    MapInfo = new AMap.Map('AllmapContainer', {\n        mask: boundaries.map(b => [b]), \n        viewMode: '3D',\n        center: [110.5059, 25.2102],\n        zoom: 10.8,\n        pitch: 50,\n        layers: [new AMap.TileLayer.RoadNet(), new AMap.TileLayer.Satellite()],\n        mapStyle: \"amap://styles/你的自定义样式\"\n    });\n\n    const object3Dlayer = new AMap.Object3DLayer();\n    MapInfo.add(object3Dlayer);\n    const wall = new AMap.Object3D.Wall({\n        path: boundaries[0],\n        height: -5000,\n        color: 'rgba(4,120,215,0.5)'\n    });\n    object3Dlayer.add(wall);\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("ul",[a("li",[s._v("设置遮罩效果（仅显示灵川县区域）")]),s._v(" "),a("li",[s._v("添加3D地形凹陷效果")])]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"_5️⃣-绘制县界线条"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5️⃣-绘制县界线条"}},[s._v("#")]),s._v(" 5️⃣ 绘制县界线条")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("function drawCountyBoundary(boundaries) {\n    boundaries.forEach(boundary => {\n        new AMap.Polyline({\n            path: boundary,\n            strokeColor: '#6edcff',\n            strokeWeight: 5,\n            map: MapInfo\n        });\n    });\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("ul",[a("li",[s._v("县边界高亮描边")])]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"_6️⃣-加载乡镇边界-geojson"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6️⃣-加载乡镇边界-geojson"}},[s._v("#")]),s._v(" 6️⃣ 加载乡镇边界（GeoJSON）")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('function drawTownshipsFromGeoJSON(url) {\n    $.getJSON(url, function(geojson) {\n        geojson.features.forEach(feature => {\n            const name = feature.properties.name;\n            const coords = feature.geometry.coordinates;\n            if (feature.geometry.type === "Polygon") {\n                drawOnePolygon(coords, name);\n            } else if (feature.geometry.type === "MultiPolygon") {\n                coords.forEach(polygonCoords => {\n                    drawOnePolygon(polygonCoords, name);\n                });\n            }\n        });\n    });\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("ul",[a("li",[s._v("动态读取本地 "),a("code",[s._v("geojson.json")]),s._v(" 文件")]),s._v(" "),a("li",[s._v("支持多边形与多面绘制")])]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"_7️⃣-绘制单个乡镇边界-名称标注"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7️⃣-绘制单个乡镇边界-名称标注"}},[s._v("#")]),s._v(" 7️⃣ 绘制单个乡镇边界 + 名称标注")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("function drawOnePolygon(coordinates, name) {\n    const path = coordinates[0].map(coord => new AMap.LngLat(coord[0], coord[1]));\n    const polygon = new AMap.Polygon({\n        path: path,\n        strokeColor: '#FF6600',\n        strokeWeight: 2,\n        fillColor: getRandomColor(),\n        fillOpacity: 0.4,\n        map: MapInfo\n    });\n\n    const center = turf.centroid(turf.polygon([coordinates[0]])).geometry.coordinates;\n    const text = new AMap.Text({\n        text: name,\n        position: center,\n        style: { padding: '2px 4px', backgroundColor: '#fff', border: '1px solid #333', fontSize: '12px' },\n        map: MapInfo\n    });\n\n    townshipOverlays.push(polygon, text);\n\n    // 额外从高德API动态绘制重点乡镇边界\n    var districtSearch = new AMap.DistrictSearch({ subdistrict: 0, extensions: 'all' });\n    ['大圩镇', '大境瑶族乡', '灵田镇', '海洋乡', '三街镇', '兰田瑶族乡'].forEach(town => {\n        districtSearch.search(town, function (status, result) {\n            if (status === 'complete' && result.info === 'OK') {\n                var bounds = result.districtList[0].boundaries;\n                var polygon = new AMap.Polygon({\n                    path: bounds,\n                    strokeColor: \"#ffffff\",\n                    strokeWeight: 3,\n                    fillOpacity: 0.35,\n                    fillColor: \"#1791fc\"\n                });\n                MapInfo.add(polygon);\n            }\n        });\n    });\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br")])]),a("ul",[a("li",[s._v("自定义多边形与随机填充色")]),s._v(" "),a("li",[s._v("Turf.js 计算标签中心")]),s._v(" "),a("li",[s._v("重点乡镇支持从高德实时绘制（备用方案）")])]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"_8️⃣-工具函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8️⃣-工具函数"}},[s._v("#")]),s._v(" 8️⃣ 工具函数")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("随机颜色生成")])])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("function getRandomColor() {\n    return `#${Math.floor(Math.random() * 16777215).toString(16)}`;\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ul",[a("li",[a("strong",[s._v("清除乡镇覆盖物")])])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("function clearTownshipOverlays() {\n    townshipOverlays.forEach(overlay => MapInfo.remove(overlay));\n    townshipOverlays = [];\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("hr"),s._v(" "),a("h2",{attrs:{id:"项目优化建议"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#项目优化建议"}},[s._v("#")]),s._v(" 项目优化建议")]),s._v(" "),a("ul",[a("li",[s._v("乡镇边界优先用 GeoJSON 绘制（统一风格）")]),s._v(" "),a("li",[s._v("高德 API 绘制仅用于动态重点乡镇")]),s._v(" "),a("li",[s._v("后期可接入景区点标记，加载 POI 信息")])]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"结语"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#结语"}},[s._v("#")]),s._v(" 结语")]),s._v(" "),a("p",[s._v("本项目完整展示了一个基于高德地图和Turf.js的行政区划绘制项目。适用于乡镇展示、政务平台、旅游门户等业务开发。")]),s._v(" "),a("p",[s._v("如果你对前端地图开发感兴趣，欢迎关注我，更多项目持续更新！")])])}),[],!1,null,null,null);a.default=e.exports}}]);