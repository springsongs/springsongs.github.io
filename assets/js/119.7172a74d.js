(window.webpackJsonp=window.webpackJsonp||[]).push([[119],{417:function(s,t,a){"use strict";a.r(t);var e=a(4),r=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"typescript-基本用法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#typescript-基本用法"}},[s._v("#")]),s._v(" TypeScript 基本用法")]),s._v(" "),t("blockquote",[t("p",[s._v("作者："),t("a",{attrs:{href:"https://wangdoc.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("来自网道项目"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("本站地址："),t("a",{attrs:{href:"http://springsongs.cn",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://springsongs.cn"),t("OutboundLink")],1)])]),s._v(" "),t("p",[s._v("本章介绍 TypeScript 的一些最基本的语法和用法。")]),s._v(" "),t("h2",{attrs:{id:"类型声明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#类型声明"}},[s._v("#")]),s._v(" 类型声明")]),s._v(" "),t("p",[s._v("TypeScript 代码最明显的特征，就是为 JavaScript 变量加上了类型声明。")]),s._v(" "),t("div",{staticClass:"language-typescript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-typescript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" foo"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("上面示例中，变量"),t("code",[s._v("foo")]),s._v("的后面使用冒号，声明了它的类型为"),t("code",[s._v("string")]),s._v("。")]),s._v(" "),t("p",[s._v("类型声明的写法，一律为在标识符后面添加“冒号 + 类型”。函数参数和返回值，也是这样来声明类型。")]),s._v(" "),t("div",{staticClass:"language-typescript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-typescript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("toString")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("num"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("number")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("num"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("上面示例中，函数"),t("code",[s._v("toString()")]),s._v("的参数"),t("code",[s._v("num")]),s._v("的类型是"),t("code",[s._v("number")]),s._v("。参数列表的圆括号后面，声明了返回值的类型是"),t("code",[s._v("string")]),s._v("。更详细的介绍，参见《函数》一章。")]),s._v(" "),t("p",[s._v("注意，变量的值应该与声明的类型一致，如果不一致，TypeScript 就会报错。")]),s._v(" "),t("div",{staticClass:"language-typescript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-typescript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 报错")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" foo"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("123")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("上面示例中，变量"),t("code",[s._v("foo")]),s._v("的类型是字符串，但是赋值为数值"),t("code",[s._v("123")]),s._v("，TypeScript 就报错了。")]),s._v(" "),t("p",[s._v("另外，TypeScript 规定，变量只有赋值后才能使用，否则就会报错。")]),s._v(" "),t("div",{staticClass:"language-typescript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-typescript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" x"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("number")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 报错")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("上面示例中，变量"),t("code",[s._v("x")]),s._v("没有赋值就被读取，导致报错。而 JavaScript 允许这种行为，不会报错，没有赋值的变量会返回"),t("code",[s._v("undefined")]),s._v("。")]),s._v(" "),t("h2",{attrs:{id:"类型推断"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#类型推断"}},[s._v("#")]),s._v(" 类型推断")]),s._v(" "),t("p",[s._v("类型声明并不是必需的，如果没有，TypeScript 会自己推断类型。")]),s._v(" "),t("div",{staticClass:"language-typescript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-typescript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" foo "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("123")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("上面示例中，变量"),t("code",[s._v("foo")]),s._v("并没有类型声明，TypeScript 就会推断它的类型。由于它被赋值为一个数值，因此 TypeScript 推断它的类型为"),t("code",[s._v("number")]),s._v("。")]),s._v(" "),t("p",[s._v("后面，如果变量"),t("code",[s._v("foo")]),s._v("更改为其他类型的值，跟推断的类型不一致，TypeScript 就会报错。")]),s._v(" "),t("div",{staticClass:"language-typescript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-typescript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" foo "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("123")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nfoo "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'hello'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 报错")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("上面示例中，变量"),t("code",[s._v("foo")]),s._v("的类型推断为"),t("code",[s._v("number")]),s._v("，后面赋值为字符串，TypeScript 就报错了。")]),s._v(" "),t("p",[s._v("TypeScript 也可以推断函数的返回值。")]),s._v(" "),t("div",{staticClass:"language-typescript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-typescript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("toString")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("num"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("number")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("num"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("上面示例中，函数"),t("code",[s._v("toString()")]),s._v("没有声明返回值的类型，但是 TypeScript 推断返回的是字符串。正是因为 TypeScript 的类型推断，所以函数返回值的类型通常是省略不写的。")]),s._v(" "),t("p",[s._v("从这里可以看到，TypeScript 的设计思想是，类型声明是可选的，你可以加，也可以不加。即使不加类型声明，依然是有效的 TypeScript 代码，只是这时不能保证 TypeScript 会正确推断出类型。由于这个原因，所有 JavaScript 代码都是合法的 TypeScript 代码。")]),s._v(" "),t("p",[s._v("这样设计还有一个好处，将以前的 JavaScript 项目改为 TypeScript 项目时，你可以逐步地为老代码添加类型，即使有些代码没有添加，也不会无法运行。")]),s._v(" "),t("h2",{attrs:{id:"typescript-的编译"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#typescript-的编译"}},[s._v("#")]),s._v(" TypeScript 的编译")]),s._v(" "),t("p",[s._v("JavaScript 的运行环境（浏览器和 Node.js）不认识 TypeScript 代码。所以，TypeScript 项目要想运行，必须先转为 JavaScript 代码，这个代码转换的过程就叫做“编译”（compile）。")]),s._v(" "),t("p",[s._v("TypeScript 官方没有做运行环境，只提供编译器。编译时，会将类型声明和类型相关的代码全部删除，只留下能运行的 JavaScript 代码，并且不会改变 JavaScript 的运行结果。")]),s._v(" "),t("p",[s._v("因此，TypeScript 的类型检查只是编译时的类型检查，而不是运行时的类型检查。一旦代码编译为 JavaScript，运行时就不再检查类型了。")]),s._v(" "),t("h2",{attrs:{id:"值与类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#值与类型"}},[s._v("#")]),s._v(" 值与类型")]),s._v(" "),t("p",[s._v("学习 TypeScript 需要分清楚“值”（value）和“类型”（type）。")]),s._v(" "),t("p",[s._v("“类型”是针对“值”的，可以视为是后者的一个元属性。每一个值在 TypeScript 里面都是有类型的。比如，"),t("code",[s._v("3")]),s._v("是一个值，它的类型是"),t("code",[s._v("number")]),s._v("。")]),s._v(" "),t("p",[s._v("TypeScript 代码只涉及类型，不涉及值。所有跟“值”相关的处理，都由 JavaScript 完成。")]),s._v(" "),t("p",[s._v("这一点务必牢记。TypeScript 项目里面，其实存在两种代码，一种是底层的“值代码”，另一种是上层的“类型代码”。前者使用 JavaScript 语法，后者使用 TypeScript 的类型语法。")]),s._v(" "),t("p",[s._v("它们是可以分离的，TypeScript 的编译过程，实际上就是把“类型代码”全部拿掉，只保留“值代码”。")]),s._v(" "),t("p",[s._v("编写 TypeScript 项目时，不要混淆哪些是值代码，哪些是类型代码。")]),s._v(" "),t("h2",{attrs:{id:"typescript-playground"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#typescript-playground"}},[s._v("#")]),s._v(" TypeScript Playground")]),s._v(" "),t("p",[s._v("最简单的 TypeScript 使用方法，就是使用官网的在线编译页面，叫做 "),t("a",{attrs:{href:"http://www.typescriptlang.org/play/",target:"_blank",rel:"noopener noreferrer"}},[s._v("TypeScript Playground"),t("OutboundLink")],1),s._v("。")]),s._v(" "),t("p",[s._v("只要打开这个网页，把 TypeScript 代码贴进文本框，它就会在当前页面自动编译出 JavaScript 代码，还可以在浏览器执行编译产物。如果编译报错，它也会给出详细的报错信息。")]),s._v(" "),t("p",[s._v("这个页面还具有支持完整的 IDE 支持，可以自动语法提示。此外，它支持把代码片段和编译器设置保存成 URL，分享给他人。")]),s._v(" "),t("p",[s._v("本书的示例都建议放到这个页面，进行查看和编译。")]),s._v(" "),t("h2",{attrs:{id:"tsc-编译器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tsc-编译器"}},[s._v("#")]),s._v(" tsc 编译器")]),s._v(" "),t("p",[s._v("TypeScript 官方提供的编译器叫做 tsc，可以将 TypeScript 脚本编译成 JavaScript 脚本。本机想要编译 TypeScript 代码，必须安装 tsc。")]),s._v(" "),t("p",[s._v("根据约定，TypeScript 脚本文件使用"),t("code",[s._v(".ts")]),s._v("后缀名，JavaScript 脚本文件使用"),t("code",[s._v(".js")]),s._v("后缀名。tsc 的作用就是把"),t("code",[s._v(".ts")]),s._v("脚本转变成"),t("code",[s._v(".js")]),s._v("脚本。")]),s._v(" "),t("h3",{attrs:{id:"安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),t("p",[s._v("tsc 是一个 npm 模块，使用下面的命令安装（必须先安装 npm）。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-g")]),s._v(" typescript\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("上面命令是全局安装 tsc，也可以在项目中将 tsc 安装为一个依赖模块。")]),s._v(" "),t("p",[s._v("安装完成后，检查一下是否安装成功。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者 tsc --version")]),s._v("\n$ tsc "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v("\nVersion "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.1")]),s._v(".6\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("上面命令中，"),t("code",[s._v("-v")]),s._v("或"),t("code",[s._v("--version")]),s._v("参数可以输出当前安装的 tsc 版本。")]),s._v(" "),t("h3",{attrs:{id:"帮助信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#帮助信息"}},[s._v("#")]),s._v(" 帮助信息")]),s._v(" "),t("p",[t("code",[s._v("-h")]),s._v("或"),t("code",[s._v("--help")]),s._v("参数输出帮助信息。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ tsc "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("默认情况下，“--help”参数仅显示基本的可用选项。我们可以使用“--all”参数，查看完整的帮助信息。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ tsc "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--all")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"编译脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#编译脚本"}},[s._v("#")]),s._v(" 编译脚本")]),s._v(" "),t("p",[s._v("安装 tsc 之后，就可以编译 TypeScript 脚本了。")]),s._v(" "),t("p",[t("code",[s._v("tsc")]),s._v("命令后面，加上 TypeScript 脚本文件，就可以将其编译成 JavaScript 脚本。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ tsc app.ts\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("上面命令会在当前目录下，生成一个"),t("code",[s._v("app.js")]),s._v("脚本文件，这个脚本就完全是编译后生成的 JavaScript 代码。")]),s._v(" "),t("p",[t("code",[s._v("tsc")]),s._v("命令也可以一次编译多个 TypeScript 脚本。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ tsc file1.ts file2.ts file3.ts\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("上面命令会在当前目录生成三个 JavaScript 脚本文件"),t("code",[s._v("file1.js")]),s._v("、"),t("code",[s._v("file2.js")]),s._v("、"),t("code",[s._v("file3.js")]),s._v("。")]),s._v(" "),t("p",[s._v("tsc 有很多参数，可以调整编译行为。")]),s._v(" "),t("p",[t("strong",[s._v("（1）--outFile")])]),s._v(" "),t("p",[s._v("如果想将多个 TypeScript 脚本编译成一个 JavaScript 文件，使用"),t("code",[s._v("--outFile")]),s._v("参数。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ tsc file1.ts file2.ts "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--outFile")]),s._v(" app.js\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("上面命令将"),t("code",[s._v("file1.ts")]),s._v("和"),t("code",[s._v("file2.ts")]),s._v("两个脚本编译成一个 JavaScript 文件"),t("code",[s._v("app.js")]),s._v("。")]),s._v(" "),t("p",[t("strong",[s._v("（2）--outDir")])]),s._v(" "),t("p",[s._v("编译结果默认都保存在当前目录，"),t("code",[s._v("--outDir")]),s._v("参数可以指定保存到其他目录。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ tsc app.ts "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--outDir")]),s._v(" dist\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("上面命令会在"),t("code",[s._v("dist")]),s._v("子目录下生成"),t("code",[s._v("app.js")]),s._v("。")]),s._v(" "),t("p",[t("strong",[s._v("（3）--target")])]),s._v(" "),t("p",[s._v("为了保证编译结果能在各种 JavaScript 引擎运行，tsc 默认会将 TypeScript 代码编译成很低版本的 JavaScript，即3.0版本（以"),t("code",[s._v("es3")]),s._v("表示）。这通常不是我们想要的结果。")]),s._v(" "),t("p",[s._v("这时可以使用"),t("code",[s._v("--target")]),s._v("参数，指定编译后的 JavaScript 版本。建议使用"),t("code",[s._v("es2015")]),s._v("，或者更新版本。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ tsc "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--target")]),s._v(" es2015 app.ts\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"编译错误的处理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#编译错误的处理"}},[s._v("#")]),s._v(" 编译错误的处理")]),s._v(" "),t("p",[s._v("编译过程中，如果没有报错，"),t("code",[s._v("tsc")]),s._v("命令不会有任何显示。所以，如果你没有看到任何提示，就表示编译成功了。")]),s._v(" "),t("p",[s._v("如果编译报错，"),t("code",[s._v("tsc")]),s._v("命令就会显示报错信息，但是这种情况下，依然会编译生成 JavaScript 脚本。")]),s._v(" "),t("p",[s._v("举例来说，下面是一个错误的 TypeScript 脚本"),t("code",[s._v("app.ts")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-typescript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-typescript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// app.ts")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" foo"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("number")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("123")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nfoo "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'abc'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 报错")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("上面示例中，变量"),t("code",[s._v("foo")]),s._v("是数值类型，赋值为字符串，"),t("code",[s._v("tsc")]),s._v("命令编译这个脚本就会报错。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ tsc app.ts\n\napp.ts:2:1 - error TS2322: Type "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'string'")]),s._v(" is not assignable to "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("type")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'number'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" foo "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'abc'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  ~~~\n\nFound "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" error "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" app.ts:2\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("上面示例中，"),t("code",[s._v("tsc")]),s._v("命令输出报错信息，表示变量"),t("code",[s._v("foo")]),s._v("被错误地赋值为字符串。")]),s._v(" "),t("p",[s._v("这种情况下，编译产物"),t("code",[s._v("app.js")]),s._v("还是会照样生成，下面就是编译后的结果。")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// app.js")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" foo "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("123")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nfoo "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'abc'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("可以看到，尽管有错，tsc 依然原样将 TypeScript 编译成 JavaScript 脚本。")]),s._v(" "),t("p",[s._v("这是因为 TypeScript 团队认为，编译器的作用只是给出编译错误，至于怎么处理这些错误，那就是开发者自己的判断了。开发者更了解自己的代码，所以不管怎样，编译产物都会生成，让开发者决定下一步怎么处理。")]),s._v(" "),t("p",[s._v("如果希望一旦报错就停止编译，不生成编译产物，可以使用"),t("code",[s._v("--noEmitOnError")]),s._v("参数。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ tsc "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--noEmitOnError")]),s._v(" app.ts\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("上面命令在报错后，就不会生成"),t("code",[s._v("app.js")]),s._v("。")]),s._v(" "),t("p",[s._v("tsc 还有一个"),t("code",[s._v("--noEmit")]),s._v("参数，只检查类型是否正确，不生成 JavaScript 文件。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ tsc "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--noEmit")]),s._v(" app.ts\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("上面命令只检查是否有编译错误，不会生成"),t("code",[s._v("app.js")]),s._v("。")]),s._v(" "),t("p",[s._v("tsc 命令的更多参数，详见《tsc 编译器》一章。")]),s._v(" "),t("h3",{attrs:{id:"tsconfig-json"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tsconfig-json"}},[s._v("#")]),s._v(" tsconfig.json")]),s._v(" "),t("p",[s._v("TypeScript 允许将"),t("code",[s._v("tsc")]),s._v("的编译参数，写在配置文件"),t("code",[s._v("tsconfig.json")]),s._v("。只要当前目录有这个文件，"),t("code",[s._v("tsc")]),s._v("就会自动读取，所以运行时可以不写参数。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ tsc file1.ts file2.ts "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--outFile")]),s._v(" dist/app.js\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("上面这个命令写成"),t("code",[s._v("tsconfig.json")]),s._v("，就是下面这样。")]),s._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"files"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"file1.ts"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"file2.ts"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"compilerOptions"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"outFile"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dist/app.js"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("有了这个配置文件，编译时直接调用"),t("code",[s._v("tsc")]),s._v("命令就可以了。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ tsc\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("code",[s._v("tsconfig.json")]),s._v("的详细介绍，参见《tsconfig.json 配置文件》一章。")]),s._v(" "),t("h2",{attrs:{id:"ts-node-模块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ts-node-模块"}},[s._v("#")]),s._v(" ts-node 模块")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/TypeStrong/ts-node",target:"_blank",rel:"noopener noreferrer"}},[s._v("ts-node"),t("OutboundLink")],1),s._v(" 是一个非官方的 npm 模块，可以直接运行 TypeScript 代码。")]),s._v(" "),t("p",[s._v("使用时，可以先全局安装它。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-g")]),s._v(" ts-node\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("安装后，就可以直接运行 TypeScript 脚本。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ ts-node script.ts\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("上面命令运行了 TypeScript 脚本"),t("code",[s._v("script.ts")]),s._v("，给出运行结果。")]),s._v(" "),t("p",[s._v("如果不安装 ts-node，也可以通过 npx 调用它来运行 TypeScript 脚本。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ npx ts-node script.ts\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("上面命令中，"),t("code",[s._v("npx")]),s._v("会在线调用 ts-node，从而在不安装的情况下，运行"),t("code",[s._v("script.ts")]),s._v("。")]),s._v(" "),t("p",[s._v("如果执行 ts-node 命令不带有任何参数，它会提供一个 TypeScript 的命令行 REPL 运行环境，你可以在这个环境中输入 TypeScript 代码，逐行执行。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ ts-node\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("上面示例中，单独运行"),t("code",[s._v("ts-node")]),s._v("命令，会给出一个大于号，这就是 TypeScript 的 REPL 运行环境，可以逐行输入代码运行。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ ts-node\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" const twice "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x:string"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" x + x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" twice"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'abc'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'abcabc'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("上面示例中，在 TypeScript 命令行 REPL 环境中，先输入一个函数"),t("code",[s._v("twice")]),s._v("，然后调用该函数，就会得到结果。")]),s._v(" "),t("p",[s._v("要退出这个 REPL 环境，可以按下 Ctrl + d，或者输入"),t("code",[s._v(".exit")]),s._v("。")]),s._v(" "),t("p",[s._v("如果只是想简单运行 TypeScript 代码看看结果，ts-node 不失为一个便捷的方法。")])])}),[],!1,null,null,null);t.default=r.exports}}]);