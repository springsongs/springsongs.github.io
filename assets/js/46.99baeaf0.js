(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{345:function(s,a,e){"use strict";e.r(a);var t=e(4),n=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"操作历史"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#操作历史"}},[s._v("#")]),s._v(" 操作历史")]),s._v(" "),a("blockquote",[a("p",[s._v("作者："),a("a",{attrs:{href:"https://wangdoc.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("来自网道项目"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("本站地址："),a("a",{attrs:{href:"http://springsongs.cn",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://springsongs.cn"),a("OutboundLink")],1)])]),s._v(" "),a("h2",{attrs:{id:"简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[s._v("#")]),s._v(" 简介")]),s._v(" "),a("p",[s._v("Bash 会保留用户的操作历史，即用户输入的每一条命令都会记录，默认是保存最近的500条命令。有了操作历史以后，就可以使用方向键的"),a("code",[s._v("↑")]),s._v("和"),a("code",[s._v("↓")]),s._v("，快速浏览上一条和下一条命令。")]),s._v(" "),a("p",[s._v("退出当前 Shell 的时候，Bash 会将用户在当前 Shell 的操作历史写入"),a("code",[s._v("~/.bash_history")]),s._v("文件，该文件默认储存500个操作。")]),s._v(" "),a("p",[s._v("环境变量"),a("code",[s._v("HISTFILE")]),s._v("总是指向这个文件。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HISTFILE")]),s._v("\n/home/me/.bash_history\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"history-命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#history-命令"}},[s._v("#")]),s._v(" history 命令")]),s._v(" "),a("p",[a("code",[s._v("history")]),s._v("命令会输出"),a("code",[s._v(".bash_history")]),s._v("文件的全部内容，即输出操作历史。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("498")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" Goodbye\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("499")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" ~\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("用户可以使用这个命令，查看最近的操作。相比直接读取"),a("code",[s._v(".bash_history")]),s._v("文件，它的优势在于所有命令之前加上了行号。最近的操作在最后面，行号最大。")]),s._v(" "),a("p",[s._v("如果想搜索某个以前执行的命令，可以配合"),a("code",[s._v("grep")]),s._v("命令搜索操作历史。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" /usr/bin\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("上面命令返回"),a("code",[s._v(".bash_history")]),s._v("文件里面，那些包含"),a("code",[s._v("/usr/bin")]),s._v("的命令。")]),s._v(" "),a("p",[a("code",[s._v("history")]),s._v("命令的"),a("code",[s._v("-c")]),s._v("参数可以清除操作历史，即清空"),a("code",[s._v(".bash_history")]),s._v("文件。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"环境变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#环境变量"}},[s._v("#")]),s._v(" 环境变量")]),s._v(" "),a("h3",{attrs:{id:"histtimeformat"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#histtimeformat"}},[s._v("#")]),s._v(" HISTTIMEFORMAT")]),s._v(" "),a("p",[s._v("通过定制环境变量"),a("code",[s._v("HISTTIMEFORMAT")]),s._v("，"),a("code",[s._v("history")]),s._v("的输出结果还可以显示每个操作的时间。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HISTTIMEFORMAT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%F %T  '")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2013")]),s._v("-06-09 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":40:12   "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/issue\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2013")]),s._v("-06-09 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":40:12   "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("clear")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("上面代码中，"),a("code",[s._v("%F")]),s._v("相当于"),a("code",[s._v("%Y - %m - %d")]),s._v("（年-月-日），"),a("code",[s._v("%T")]),s._v("相当于"),a("code",[s._v("%H : %M : %S")]),s._v("（时:分:秒）。")]),s._v(" "),a("p",[s._v("只要设置"),a("code",[s._v("HISTTIMEFORMAT")]),s._v("这个环境变量，就会在"),a("code",[s._v(".bash_history")]),s._v("文件保存命令的执行时间戳。如果不设置，就不会保存时间戳。")]),s._v(" "),a("h3",{attrs:{id:"histsize"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#histsize"}},[s._v("#")]),s._v(" HISTSIZE")]),s._v(" "),a("p",[s._v("环境变量"),a("code",[s._v("HISTSIZE")]),s._v("设置保存历史操作的数量。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("HISTSIZE")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("上面命令设置保存过去10000条操作历史。")]),s._v(" "),a("p",[s._v("如果不希望保存本次操作的历史，可以设置"),a("code",[s._v("HISTSIZE")]),s._v("等于0。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("HISTSIZE")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("如果"),a("code",[s._v("HISTSIZE=0")]),s._v("写入用户主目录的"),a("code",[s._v("~/.bashrc")]),s._v("文件，那么就不会保留该用户的操作历史。如果写入"),a("code",[s._v("/etc/profile")]),s._v("，整个系统都不会保留操作历史。")]),s._v(" "),a("h3",{attrs:{id:"histignore"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#histignore"}},[s._v("#")]),s._v(" HISTIGNORE")]),s._v(" "),a("p",[s._v("环境变量"),a("code",[s._v("HISTIGNORE")]),s._v("可以设置哪些命令不写入操作历史。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HISTIGNORE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pwd:ls:exit'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("上面示例设置，"),a("code",[s._v("pwd")]),s._v("、"),a("code",[s._v("ls")]),s._v("、"),a("code",[s._v("exit")]),s._v("这三个命令不写入操作历史。")]),s._v(" "),a("h2",{attrs:{id:"ctrl-r"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ctrl-r"}},[s._v("#")]),s._v(" Ctrl + r")]),s._v(" "),a("p",[s._v("输入命令时，按下"),a("code",[s._v("Ctrl + r")]),s._v("快捷键，就可以搜索操作历史，选择以前执行过的命令。")]),s._v(" "),a("p",[a("code",[s._v("Ctrl + r")]),s._v("相当于打开一个"),a("code",[s._v(".bash_history")]),s._v("文件的搜索接口，直接键入命令的开头部分，Shell 就会自动在该文件中反向查询（即先查询最近的命令），显示最近一条匹配的结果，这时按下回车键，就会执行那条命令。")]),s._v(" "),a("h2",{attrs:{id:"命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#命令"}},[s._v("#")]),s._v(" ! 命令")]),s._v(" "),a("h3",{attrs:{id:"行号"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#行号"}},[s._v("#")]),s._v(" ! + 行号")]),s._v(" "),a("p",[s._v("操作历史的每一条记录都有行号。知道了命令的行号以后，可以用"),a("code",[s._v("感叹号 + 行号")]),s._v("执行该命令。如果想要执行"),a("code",[s._v(".bash_history")]),s._v("里面的第8条命令，可以像下面这样操作。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"数字"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数字"}},[s._v("#")]),s._v(" !- 数字")]),s._v(" "),a("p",[s._v("如果想执行本次 Shell 对话中倒数的命令，比如执行倒数第3条命令，就可以输入"),a("code",[s._v("!-3")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" a.txt\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" b.txt\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" c.txt\n\n$ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("-3\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" a.txt\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("上面示例中，"),a("code",[s._v("!-3")]),s._v("返回倒数第3条命令，即"),a("code",[s._v("touch a.txt")]),s._v("。")]),s._v(" "),a("p",[s._v("它跟"),a("code",[s._v("! + 行号")]),s._v("的主要区别是，后者是在"),a("code",[s._v(".bash_history")]),s._v("文件中从头开始计算行数，而"),a("code",[s._v("!- 数字")]),s._v("是从底部开始向上计算行数。")]),s._v(" "),a("h3",{attrs:{id:""}},[a("a",{staticClass:"header-anchor",attrs:{href:"#"}},[s._v("#")]),s._v(" !!")]),s._v(" "),a("p",[a("code",[s._v("!!")]),s._v("命令返回上一条命令。如果需要重复执行某一条命令，就可以不断键入"),a("code",[s._v("!!")]),s._v("，这样非常方便。它等同于"),a("code",[s._v("!-1")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" hello\nhello\n\n$ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" hello\nhello\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("上面示例中，"),a("code",[s._v("!!")]),s._v("会返回并执行上一条命令"),a("code",[s._v("echo hello")]),s._v("。")]),s._v(" "),a("p",[s._v("有时候，我们使用某条命令，系统报错没有权限，这时就可以使用"),a("code",[s._v("sudo !!")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 报错，没有执行权限")]),s._v("\n$ yum update\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum update\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("上面示例中，"),a("code",[s._v("sudo !!")]),s._v("返回"),a("code",[s._v("sudo yum update")]),s._v("，从而就可以正确执行了。")]),s._v(" "),a("h3",{attrs:{id:"搜索词"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#搜索词"}},[s._v("#")]),s._v(" ! + 搜索词")]),s._v(" "),a("p",[a("code",[s._v("感叹号 + 搜索词")]),s._v("可以快速执行匹配的命令。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" Hello World\nHello World\n\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" Goodbye\nGoodbye\n\n$ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("e\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" Goodbye\nGoodbye\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("上面例子中，"),a("code",[s._v("!e")]),s._v("表示找出操作历史之中，最近的那一条以"),a("code",[s._v("e")]),s._v("开头的命令并执行。Bash 会先输出那一条命令"),a("code",[s._v("echo Goodbye")]),s._v("，然后直接执行。")]),s._v(" "),a("p",[s._v("同理，"),a("code",[s._v("!echo")]),s._v("也会执行最近一条以"),a("code",[s._v("echo")]),s._v("开头的命令。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("echo\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" Goodbye\nGoodbye\n\n$ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("echo H\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" Goodbye H\nGoodbye H\n\n$ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("echo H G\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" Goodbye H G\nGoodbye H G\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("注意，"),a("code",[s._v("感叹号 + 搜索词")]),s._v("语法只会匹配命令，不会匹配参数。所以"),a("code",[s._v("!echo H")]),s._v("不会执行"),a("code",[s._v("echo Hello World")]),s._v("，而是会执行"),a("code",[s._v("echo Goodbye")]),s._v("，并把参数"),a("code",[s._v("H")]),s._v("附加在这条命令之后。同理，"),a("code",[s._v("!echo H G")]),s._v("也是等同于"),a("code",[s._v("echo Goodbye")]),s._v("命令之后附加"),a("code",[s._v("H G")]),s._v("。")]),s._v(" "),a("p",[s._v("由于"),a("code",[s._v("感叹号 + 搜索词")]),s._v("会扩展成以前执行过的命令，所以含有"),a("code",[s._v("!")]),s._v("的字符串放在双引号里面，必须非常小心，如果它后面有非空格的字符，就很有可能报错。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"I say:'),a("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("hello!"),a("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v('"')]),s._v("\nbash: "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(": event not found\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("上面的命令会报错，原因是感叹号后面是一个反斜杠，Bash 会尝试寻找，以前是否执行过反斜杠开头的命令，一旦找不到就会报错。解决方法就是在感叹号前面，也加上反斜杠。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"I say:'),a("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("hello\\!"),a("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v('"')]),s._v("\nI say:"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello\\!"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"搜索词-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#搜索词-2"}},[s._v("#")]),s._v(" !? + 搜索词")]),s._v(" "),a("p",[a("code",[s._v("!? + 搜索词")]),s._v("可以搜索命令的任意部分，包括参数部分。它跟"),a("code",[s._v("! + 搜索词")]),s._v("的主要区别是，后者是从行首开始匹配。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" hello.txt\nHello world "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n\n$ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("?hello.txt\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" hello.txt\nHello world "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("上面示例中，"),a("code",[s._v("!?hello.txt")]),s._v("会返回最近一条包括"),a("code",[s._v("hello.txt")]),s._v("的命令。")]),s._v(" "),a("h3",{attrs:{id:"-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#-2"}},[s._v("#")]),s._v(" !$，!*")]),s._v(" "),a("p",[a("code",[s._v("!$")]),s._v("代表上一个命令的最后一个参数，它的另一种写法是"),a("code",[s._v("$_")]),s._v("。")]),s._v(" "),a("p",[a("code",[s._v("!*")]),s._v("代表上一个命令的所有参数，即除了命令以外的所有部分。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" a.txt b.txt\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("$\nb.txt\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" a.txt b.txt\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("*\na.txt b.txt\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("上面示例中，"),a("code",[s._v("!$")]),s._v("代表上一个命令的最后一个参数（"),a("code",[s._v("b.txt")]),s._v("），"),a("code",[s._v("!*")]),s._v("代表上一个命令的所有参数（"),a("code",[s._v("a.txt b.txt")]),s._v("）。")]),s._v(" "),a("p",[s._v("如果想匹配上一个命令的某个指定位置的参数，使用"),a("code",[s._v("!:n")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" a.txt b.txt c.txt\n\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(":2\nb.txt\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("上面示例中，"),a("code",[s._v("!:2")]),s._v("返回上一条命令的第二个参数（"),a("code",[s._v("b.txt")]),s._v("）。")]),s._v(" "),a("p",[s._v("这种写法的"),a("code",[s._v("!:$")]),s._v("，代表上一个命令的最后一个参数。事实上，"),a("code",[s._v("!$")]),s._v("就是"),a("code",[s._v("!:$")]),s._v("的简写形式。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" a.txt b.txt c.txt\n\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(":$\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" c.txt\nc.txt\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("上面示例中，"),a("code",[s._v("!:$")]),s._v("代表上一条命令的最后一个参数（"),a("code",[s._v("c.txt")]),s._v("）。")]),s._v(" "),a("p",[s._v("如果想匹配更久以前的命令的参数，可以使用"),a("code",[s._v("!<命令>:n")]),s._v("（指定位置的参数）和"),a("code",[s._v("!<命令>:$")]),s._v("（最后一个参数）。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("mkdir:$\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("上面示例中，"),a("code",[s._v("!mkdir:$")]),s._v("会返回前面最后一条"),a("code",[s._v("mkdir")]),s._v("命令的最后一个参数。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("mk:2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("上面示例中，"),a("code",[s._v("!mk:2")]),s._v("会返回前面最后一条以"),a("code",[s._v("mk")]),s._v("开头的命令的第二个参数。")]),s._v(" "),a("h3",{attrs:{id:"p"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#p"}},[s._v("#")]),s._v(" !:p")]),s._v(" "),a("p",[s._v("如果只是想输出上一条命令，而不是执行它，可以使用"),a("code",[s._v("!:p")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" hello\n\n$ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(":p\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" hello\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("上面示例中，"),a("code",[s._v("!:p")]),s._v("只会输出"),a("code",[s._v("echo hello")]),s._v("，而不会执行这条命令。")]),s._v(" "),a("p",[s._v("如果想输出最近一条匹配的命令，而不执行它，可以使用"),a("code",[s._v("!<命令>:p")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("su:p\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("上面示例中，"),a("code",[s._v("!su:p")]),s._v("会输出前面最近一条以"),a("code",[s._v("su")]),s._v("开头的命令，而不执行它。")]),s._v(" "),a("h2",{attrs:{id:"string1-string2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#string1-string2"}},[s._v("#")]),s._v(" "),a("code",[s._v("^string1^string2")])]),s._v(" "),a("p",[a("code",[s._v("^string1^string2")]),s._v("用来执行最近一条包含"),a("code",[s._v("string1")]),s._v("的命令，将其替换成"),a("code",[s._v("string2")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" /var/log/httpd/error.log\n$ ^error^access\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" /var/log/httpd/access.log\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("上面示例中，"),a("code",[s._v("^error^access")]),s._v("将最近一条含有"),a("code",[s._v("error")]),s._v("的命令里面的"),a("code",[s._v("error")]),s._v("，替换成"),a("code",[s._v("access")]),s._v("。")]),s._v(" "),a("h2",{attrs:{id:"histverify-参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#histverify-参数"}},[s._v("#")]),s._v(" histverify 参数")]),s._v(" "),a("p",[s._v("上面的那些快捷命令（比如"),a("code",[s._v("!!")]),s._v("命令），都是找到匹配的命令后，直接执行。如果希望增加一个确认步骤，先输出是什么命令，让用户确认后再执行，可以打开 Shell 的"),a("code",[s._v("histverify")]),s._v("选项。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("shopt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" histverify\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("打开"),a("code",[s._v("histverify")]),s._v("这个选项后，使用"),a("code",[s._v("!")]),s._v("快捷键所返回的命令，就会先输出，等到用户按下回车键后再执行。")]),s._v(" "),a("h2",{attrs:{id:"快捷键"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#快捷键"}},[s._v("#")]),s._v(" 快捷键")]),s._v(" "),a("p",[s._v("下面是其他一些与操作历史相关的快捷键。")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("Ctrl + p")]),s._v("：显示上一个命令，与向上箭头效果相同（previous）。")]),s._v(" "),a("li",[a("code",[s._v("Ctrl + n")]),s._v("：显示下一个命令，与向下箭头效果相同（next）。")]),s._v(" "),a("li",[a("code",[s._v("Alt + <")]),s._v("：显示第一个命令。")]),s._v(" "),a("li",[a("code",[s._v("Alt + >")]),s._v("：显示最后一个命令，即当前的命令。")]),s._v(" "),a("li",[a("code",[s._v("Ctrl + o")]),s._v("：执行历史文件里面的当前条目，并自动显示下一条命令。这对重复执行某个序列的命令很有帮助。")])]),s._v(" "),a("h2",{attrs:{id:"参考链接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考链接"}},[s._v("#")]),s._v(" 参考链接")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.redhat.com/sysadmin/bash-bang-commands",target:"_blank",rel:"noopener noreferrer"}},[s._v("Bash bang commands: A must-know trick for the Linux command line"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=n.exports}}]);